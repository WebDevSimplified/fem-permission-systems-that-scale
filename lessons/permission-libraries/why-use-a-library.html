<!DOCTYPE html><html><head><meta charSet="utf-8" data-next-head=""/><meta name="viewport" content="width=device-width" data-next-head=""/><link rel="apple-touch-icon" sizes="180x180" href="/fem-permission-systems-that-scale/images/apple-touch-icon.png" data-next-head=""/><link rel="icon" type="image/png" sizes="32x32" href="/fem-permission-systems-that-scale/images/favicon-32x32.png" data-next-head=""/><link rel="icon" type="image/png" sizes="16x16" href="/fem-permission-systems-that-scale/images/favicon-16x16.png" data-next-head=""/><link rel="icon" type="image/png" sizes="16x16" href="/fem-permission-systems-that-scale/images/favicon-16x16.png" data-next-head=""/><link rel="icon" type="image/x-icon" href="/fem-permission-systems-that-scale/images/favicon.ico" data-next-head=""/><title data-next-head="">Why Use a Permission Library? – Permission Systems that Scale</title><meta name="description" content="Learn how to implement robust permission systems in your web applications. Master RBAC, ABAC, field-level permissions, and build your own authorization engine from scratch using TypeScript." data-next-head=""/><meta name="keywords" content="Permissions,Authorization,RBAC,ABAC,Access Control,TypeScript,Security,CASL,Web Dev Simplified,Frontend Masters" data-next-head=""/><meta name="og:description" content="Learn how to implement robust permission systems in your web applications. Master RBAC, ABAC, field-level permissions, and build your own authorization engine from scratch using TypeScript." data-next-head=""/><meta name="og:title" content="Why Use a Permission Library? – Permission Systems that Scale" data-next-head=""/><meta name="og:image" content="/fem-permission-systems-that-scale/images/social-share-cover.jpg" data-next-head=""/><meta name="twitter:card" content="summary_large_image" data-next-head=""/><link data-next-font="size-adjust" rel="preconnect" href="/" crossorigin="anonymous"/><link rel="preload" href="/fem-permission-systems-that-scale/_next/static/css/3e2d260a483e4ce6.css" as="style"/><link rel="stylesheet" href="/fem-permission-systems-that-scale/_next/static/css/3e2d260a483e4ce6.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="/fem-permission-systems-that-scale/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/fem-permission-systems-that-scale/_next/static/chunks/webpack-561d6b920ac5fc2e.js" defer=""></script><script src="/fem-permission-systems-that-scale/_next/static/chunks/framework-2f335d22a7318891.js" defer=""></script><script src="/fem-permission-systems-that-scale/_next/static/chunks/main-8377b0572add80b6.js" defer=""></script><script src="/fem-permission-systems-that-scale/_next/static/chunks/pages/_app-ab9f88be91011ccd.js" defer=""></script><script src="/fem-permission-systems-that-scale/_next/static/chunks/pages/lessons/%5Bsection%5D/%5Bslug%5D-c23b0a3ff434a742.js" defer=""></script><script src="/fem-permission-systems-that-scale/_next/static/Z1s-VsOExbnNujkBZEKnx/_buildManifest.js" defer=""></script><script src="/fem-permission-systems-that-scale/_next/static/Z1s-VsOExbnNujkBZEKnx/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="remix-app"><header class="navbar"><h1 class="navbar-brand"><a href="/fem-permission-systems-that-scale">Permission Systems that Scale</a></h1><div class="navbar-info"></div></header><div class="content-container"><div class="main"><div class="lesson-container"><div class="lesson"><div class="lesson-content"><p>We&#39;ve built our own ABAC system from scratch, which is great for understanding how permissions work. But in production, you might want to use a battle-tested library instead.</p>
<h2>When to Use a Library</h2>
<p>Building your own permission system makes sense when:</p>
<ul>
<li>Learning how permissions work (like this course!)</li>
<li>You need maximum control over your permission logic</li>
<li>Your permissions aren&#39;t too complex</li>
</ul>
<p>Using a library makes sense when:</p>
<ul>
<li>You want well-tested, production-ready code</li>
<li>You need advanced features</li>
<li>You want to follow established patterns</li>
<li>Your team needs documentation and community support</li>
</ul>
<h2>Two Types of Permission Libraries</h2>
<p>Permission libraries generally fall into two main categories based on how you define policies:</p>
<h3>1. In-Code Libraries</h3>
<p>These libraries define permissions using the same programming language as your application:</p>
<pre><code class="hljs language-typescript"><button class="copy-btn">Copy</button><span class="hljs-comment">// Permissions defined in JavaScript/TypeScript</span>
<span class="hljs-keyword">const</span> ability = <span class="hljs-title function_">defineAbility</span>(<span class="hljs-function">(<span class="hljs-params">can, cannot</span>) =&gt;</span> {
  <span class="hljs-title function_">can</span>(<span class="hljs-string">&quot;read&quot;</span>, <span class="hljs-string">&quot;Document&quot;</span>, { <span class="hljs-attr">status</span>: <span class="hljs-string">&quot;published&quot;</span> })
  <span class="hljs-title function_">can</span>(<span class="hljs-string">&quot;update&quot;</span>, <span class="hljs-string">&quot;Document&quot;</span>, { <span class="hljs-attr">creatorId</span>: user.<span class="hljs-property">id</span> })
  <span class="hljs-title function_">cannot</span>(<span class="hljs-string">&quot;delete&quot;</span>, <span class="hljs-string">&quot;Document&quot;</span>, { <span class="hljs-attr">isLocked</span>: <span class="hljs-literal">true</span> })
})
</code></pre><p><strong>Pros:</strong></p>
<ul>
<li>Full IDE support (autocomplete, type checking)</li>
<li>Easy to debug (same language, same tools)</li>
<li>No context switching between languages</li>
<li>Can use application logic directly</li>
</ul>
<p><strong>Cons:</strong></p>
<ul>
<li>Policies are embedded in application code</li>
<li>Harder to externalize or share policies</li>
<li>Changes require redeploying the application (unless using a dynamic configuration system)</li>
</ul>
<p><strong>Popular in-code libraries:</strong></p>
<ul>
<li><strong>CASL</strong> (JavaScript/TypeScript)</li>
<li><strong>Pundit</strong> (Ruby)</li>
<li><strong>Cancan</strong> (Ruby)</li>
</ul>
<h3>2. DSL Libraries (Domain-Specific Language)</h3>
<p>These libraries define permissions using a dedicated policy language:</p>
<pre><code class="hljs language-ini"><button class="copy-btn">Copy</button><span class="hljs-comment"># model.conf - Defines the permission structure</span>
<span class="hljs-section">[request_definition]</span>
<span class="hljs-attr">r</span> = sub, obj, act

<span class="hljs-section">[policy_definition]</span>
<span class="hljs-attr">p</span> = sub, obj, act

<span class="hljs-section">[matchers]</span>
<span class="hljs-attr">m</span> = r.sub == p.sub &amp;&amp; r.obj == p.obj &amp;&amp; r.act == p.act
</code></pre><pre><code class="hljs language-csv"><button class="copy-btn">Copy</button># policy.csv - The actual rules
p, admin, document, read
p, admin, document, update
p, admin, document, delete
p, editor, document, read
p, editor, document, update
</code></pre><p><strong>Pros:</strong></p>
<ul>
<li>Policies are separate from application code</li>
<li>Can update policies without redeploying</li>
<li>Same policies work across different services</li>
<li>Easier to audit (policies in one place)</li>
</ul>
<p><strong>Cons:</strong></p>
<ul>
<li>Must learn a new language</li>
<li>Limited IDE support (usually)</li>
<li>Debugging across language boundary is harder</li>
<li>Extra infrastructure to manage policy files</li>
</ul>
<p><strong>Popular DSL libraries:</strong></p>
<ul>
<li><strong>Casbin</strong> - Supports multiple languages</li>
<li><strong>Open Policy Agent (OPA)</strong> - Uses Rego language</li>
<li><strong>Cedar</strong> - AWS&#39;s policy language</li>
</ul>
<h2>Our Example Libraries</h2>
<p>You may have already noticed our ABAC system is an in code system and is actually heavily inspired by CASL which we will be implementing in this course.</p>
<h3>CASL (In-Code)</h3>
<p>CASL is a popular JavaScript/TypeScript library for handling permissions:</p>
<pre><code class="hljs language-typescript"><button class="copy-btn">Copy</button><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AbilityBuilder</span>, createMongoAbility } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@casl/ability&quot;</span>

<span class="hljs-keyword">const</span> { can, build } = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AbilityBuilder</span>(createMongoAbility)

<span class="hljs-title function_">can</span>(<span class="hljs-string">&quot;read&quot;</span>, <span class="hljs-string">&quot;Document&quot;</span>, { <span class="hljs-attr">status</span>: <span class="hljs-string">&quot;published&quot;</span> })
<span class="hljs-title function_">can</span>(<span class="hljs-string">&quot;update&quot;</span>, <span class="hljs-string">&quot;Document&quot;</span>, { <span class="hljs-attr">creatorId</span>: user.<span class="hljs-property">id</span>, <span class="hljs-attr">isLocked</span>: <span class="hljs-literal">false</span> })

<span class="hljs-keyword">const</span> ability = <span class="hljs-title function_">build</span>()

<span class="hljs-comment">// Check permissions</span>
ability.<span class="hljs-title function_">can</span>(<span class="hljs-string">&quot;read&quot;</span>, <span class="hljs-title function_">subject</span>(<span class="hljs-string">&quot;Document&quot;</span>, <span class="hljs-variable language_">document</span>))
ability.<span class="hljs-title function_">can</span>(<span class="hljs-string">&quot;update&quot;</span>, <span class="hljs-title function_">subject</span>(<span class="hljs-string">&quot;Document&quot;</span>, <span class="hljs-variable language_">document</span>))
</code></pre><h3>Casbin (DSL)</h3>
<p>Casbin uses a model/policy separation where you define:</p>
<ol>
<li><strong>Model file</strong> - The structure of your permissions</li>
<li><strong>Policy file</strong> - The actual rules</li>
</ol>
<pre><code class="hljs language-ini"><button class="copy-btn">Copy</button><span class="hljs-comment"># model.conf - Defines the structure</span>
<span class="hljs-section">[request_definition]</span>
<span class="hljs-attr">r</span> = sub, obj, act

<span class="hljs-section">[policy_definition]</span>
<span class="hljs-attr">p</span> = sub, obj, act

<span class="hljs-section">[policy_effect]</span>
<span class="hljs-attr">e</span> = some(where (p.eft == allow))

<span class="hljs-section">[matchers]</span>
<span class="hljs-attr">m</span> = r.sub == p.sub &amp;&amp; r.obj == p.obj &amp;&amp; r.act == p.act
</code></pre><pre><code class="hljs language-csv"><button class="copy-btn">Copy</button># policy.csv - The actual rules
p, admin, document, read
p, admin, document, create
p, admin, document, update
p, admin, document, delete
p, editor, document, read
p, editor, document, update
</code></pre><p>Casbin&#39;s approach is much harder to parse until you learn the language around it, but it is more flexible since you can use it across multiple languages and services.</p>
<h2>Which Should You Choose?</h2>
<table>
<thead>
<tr>
<th>Factor</th>
<th>In-Code (CASL)</th>
<th>DSL (Casbin)</th>
</tr>
</thead>
<tbody><tr>
<td><strong>Learning curve</strong></td>
<td>Easy if you know JS</td>
<td>Must learn new syntax</td>
</tr>
<tr>
<td><strong>Type safety</strong></td>
<td>Full TypeScript support</td>
<td>Limited</td>
</tr>
<tr>
<td><strong>Policy updates</strong></td>
<td>May require a redeploy</td>
<td>Can update dynamically</td>
</tr>
<tr>
<td><strong>Multi-service</strong></td>
<td>Harder to share</td>
<td>Built for this</td>
</tr>
<tr>
<td><strong>Debugging</strong></td>
<td>Same tools</td>
<td>Harder</td>
</tr>
</tbody></table>
<p><strong>Choose in-code (CASL) when:</strong></p>
<ul>
<li>Your app is monolithic or has few services that use other languages</li>
<li>You want maximum type safety</li>
<li>Your team is JavaScript/TypeScript focused</li>
</ul>
<p><strong>Choose DSL (Casbin) when:</strong></p>
<ul>
<li>You have multiple services sharing policies across different languages</li>
<li>You need to update policies without deploying</li>
<li>You have a security team managing policies</li>
</ul>
<h2>What&#39;s Next</h2>
<p>In the next lesson, we&#39;ll dive deeper into how to implement CASL in our existing application.</p>
</div><div class="lesson-links"><a href="/fem-permission-systems-that-scale/lessons/abac/clean-architecture-services" class="prev">← Previous</a><a href="/fem-permission-systems-that-scale/lessons/permission-libraries/upgrading-to-casl" class="next">Next →</a></div></div><div class="details-bg"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="154" height="154" viewBox="0 0 154 154"><defs><clipPath id="clip-path"><rect id="Rectangle_2238" data-name="Rectangle 2238" width="154" height="154" transform="translate(9467 350)" fill="#fff" stroke="#707070" stroke-width="1"></rect></clipPath><clipPath id="clip-corner-image-active"><rect width="154" height="154"></rect></clipPath></defs><g id="corner-image-active" clip-path="url(#clip-corner-image-active)"><g id="Corner-image-active-2" data-name="Corner-image-active" transform="translate(-9467 -350)" clip-path="url(#clip-path)"><path id="Subtraction_34" data-name="Subtraction 34" d="M-3857.365,1740.766h0l-7.07-7.07,12.89-12.89v14.142l-5.818,5.818Zm-14.142-14.142h0l-7.071-7.07,27.033-27.033v14.143l-19.96,19.96Zm-14.143-14.143h0l-7.07-7.069,41.175-41.175v14.142Zm-14.142-14.142h0l-7.07-7.069,55.317-55.317v14.142Zm-14.142-14.142h0l-7.07-7.069,69.459-69.459v14.142Zm-14.142-14.142h0l-7.07-7.069,76.739-76.739h6.862v7.28Zm-14.143-14.143h0l-7.07-7.069,62.6-62.6h14.142Zm-14.142-14.142h0l-7.07-7.069,48.454-48.454h14.142Zm-14.142-14.142h0l-7.07-7.069,34.312-34.312h14.142Zm-14.142-14.142h0l-7.07-7.069,20.17-20.17h14.142Zm-14.142-14.142h0l-7.071-7.071,6.027-6.027h14.144l-13.1,13.1Zm367.24-56.114v-.909l.455.455-.453.453Z" transform="translate(13472.546 -1236.766)" fill="var(--corner-fill)"></path></g></g></svg></div></div></div></div><footer class="footer"><ul class="socials"><li class="social"><a href="https://twitter.com/DevSimplified"><svg fill="none" height="100%" width="32" xmlns="http://www.w3.org/2000/svg" viewBox="0.254 0.25 500 451.95400000000006"><path d="M394.033.25h76.67L303.202 191.693l197.052 260.511h-154.29L225.118 294.205 86.844 452.204H10.127l179.16-204.77L.254.25H158.46l109.234 144.417zm-26.908 406.063h42.483L135.377 43.73h-45.59z" fill="var(--footer-icons)"></path></svg></a></li><li class="social"><a href="https://github.com/WebDevSimplified"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32"><defs><clipPath id="clip-github-social"><rect width="32" height="32"></rect></clipPath></defs><g id="github-social" clip-path="url(#clip-github-social)"><g id="Group_272" data-name="Group 272" transform="translate(13522.5 -6994)"><path id="Subtraction_33" data-name="Subtraction 33" d="M-24967.5,8041a15.9,15.9,0,0,1-11.312-4.688A15.893,15.893,0,0,1-24983.5,8025a15.893,15.893,0,0,1,4.689-11.315A15.894,15.894,0,0,1-24967.5,8009a15.894,15.894,0,0,1,11.313,4.686A15.893,15.893,0,0,1-24951.5,8025a15.893,15.893,0,0,1-4.689,11.313A15.9,15.9,0,0,1-24967.5,8041Zm-3.781-4.571h0v3.918h7.895v-6.665a1.836,1.836,0,0,0-1.2-1.718c5.1-.617,7.467-2.975,7.467-7.424a7.176,7.176,0,0,0-1.637-4.728,6.74,6.74,0,0,0,.275-1.812,4.34,4.34,0,0,0-.52-2.452.574.574,0,0,0-.359-.1c-1.061,0-3.465,1.411-3.936,1.694a16.644,16.644,0,0,0-4.2-.489,16.379,16.379,0,0,0-3.969.445c-.846-.5-2.91-1.649-3.859-1.649a.566.566,0,0,0-.354.095,4.3,4.3,0,0,0-.521,2.452,6.7,6.7,0,0,0,.244,1.718,7.346,7.346,0,0,0-1.6,4.822,7.263,7.263,0,0,0,1.533,4.985c1.193,1.359,3.115,2.165,5.871,2.464a1.826,1.826,0,0,0-1.129,1.693v.5h0l-.006,0a7.121,7.121,0,0,1-2.033.363,2.608,2.608,0,0,1-.965-.158,4.438,4.438,0,0,1-1.836-1.881,2.361,2.361,0,0,0-1.248-1.091,3.472,3.472,0,0,0-1.217-.3.584.584,0,0,0-.545.224.282.282,0,0,0,.027.367,1.875,1.875,0,0,0,.447.307,4.732,4.732,0,0,1,.561.355,10.726,10.726,0,0,1,1.682,2.755c.043.092.078.163.105.217a3.876,3.876,0,0,0,2.42,1.185,6.036,6.036,0,0,0,.607.025c.875,0,1.988-.124,2-.125Z" transform="translate(11461 -1015)" fill="var(--footer-icons)"></path><g id="Ellipse_670" data-name="Ellipse 670" transform="translate(-13522.5 6994)" fill="none" stroke="var(--footer-icons)" stroke-width="1"><circle cx="16" cy="16" r="16" stroke="none"></circle><circle cx="16" cy="16" r="15.5" fill="none"></circle></g></g></g></svg></a></li><li class="social"><div class="terms"><p>Content Licensed Under CC-BY-NC-4.0</p><p>Code Samples and Exercises Licensed Under Apache 2.0</p><p>Site Designed by<!-- --> <a href="https://www.alexdanielson.com/">Alex Danielson</a></p></div></li></ul><div class="theme-icons"><button aria-label="Activate dark mode" title="Activate dark mode" class="theme-toggle"><svg xmlns="http://www.w3.org/2000/svg" width="36px" height="100%" viewBox="0 -960 960 960" fill="var(--text-footer)" role="img"><title>Dark Mode Icon</title><path d="M480-120q-150 0-255-105T120-480q0-150 105-255t255-105q14 0 27.5 1t26.5 3q-41 29-65.5 75.5T444-660q0 90 63 153t153 63q55 0 101-24.5t75-65.5q2 13 3 26.5t1 27.5q0 150-105 255T480-120Zm0-80q88 0 158-48.5T740-375q-20 5-40 8t-40 3q-123 0-209.5-86.5T364-660q0-20 3-40t8-40q-78 32-126.5 102T200-480q0 116 82 198t198 82Z"></path></svg></button></div></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"attributes":{"title":"Why Use a Permission Library?"},"html":"\u003cp\u003eWe\u0026#39;ve built our own ABAC system from scratch, which is great for understanding how permissions work. But in production, you might want to use a battle-tested library instead.\u003c/p\u003e\n\u003ch2\u003eWhen to Use a Library\u003c/h2\u003e\n\u003cp\u003eBuilding your own permission system makes sense when:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eLearning how permissions work (like this course!)\u003c/li\u003e\n\u003cli\u003eYou need maximum control over your permission logic\u003c/li\u003e\n\u003cli\u003eYour permissions aren\u0026#39;t too complex\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eUsing a library makes sense when:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eYou want well-tested, production-ready code\u003c/li\u003e\n\u003cli\u003eYou need advanced features\u003c/li\u003e\n\u003cli\u003eYou want to follow established patterns\u003c/li\u003e\n\u003cli\u003eYour team needs documentation and community support\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eTwo Types of Permission Libraries\u003c/h2\u003e\n\u003cp\u003ePermission libraries generally fall into two main categories based on how you define policies:\u003c/p\u003e\n\u003ch3\u003e1. In-Code Libraries\u003c/h3\u003e\n\u003cp\u003eThese libraries define permissions using the same programming language as your application:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-typescript\"\u003e\u003cbutton class=\"copy-btn\"\u003eCopy\u003c/button\u003e\u003cspan class=\"hljs-comment\"\u003e// Permissions defined in JavaScript/TypeScript\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e ability = \u003cspan class=\"hljs-title function_\"\u003edefineAbility\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003ecan, cannot\u003c/span\u003e) =\u0026gt;\u003c/span\u003e {\n  \u003cspan class=\"hljs-title function_\"\u003ecan\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;read\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;Document\u0026quot;\u003c/span\u003e, { \u003cspan class=\"hljs-attr\"\u003estatus\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;published\u0026quot;\u003c/span\u003e })\n  \u003cspan class=\"hljs-title function_\"\u003ecan\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;update\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;Document\u0026quot;\u003c/span\u003e, { \u003cspan class=\"hljs-attr\"\u003ecreatorId\u003c/span\u003e: user.\u003cspan class=\"hljs-property\"\u003eid\u003c/span\u003e })\n  \u003cspan class=\"hljs-title function_\"\u003ecannot\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;delete\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;Document\u0026quot;\u003c/span\u003e, { \u003cspan class=\"hljs-attr\"\u003eisLocked\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e })\n})\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e\u003cstrong\u003ePros:\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eFull IDE support (autocomplete, type checking)\u003c/li\u003e\n\u003cli\u003eEasy to debug (same language, same tools)\u003c/li\u003e\n\u003cli\u003eNo context switching between languages\u003c/li\u003e\n\u003cli\u003eCan use application logic directly\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eCons:\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ePolicies are embedded in application code\u003c/li\u003e\n\u003cli\u003eHarder to externalize or share policies\u003c/li\u003e\n\u003cli\u003eChanges require redeploying the application (unless using a dynamic configuration system)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003ePopular in-code libraries:\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCASL\u003c/strong\u003e (JavaScript/TypeScript)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ePundit\u003c/strong\u003e (Ruby)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCancan\u003c/strong\u003e (Ruby)\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003e2. DSL Libraries (Domain-Specific Language)\u003c/h3\u003e\n\u003cp\u003eThese libraries define permissions using a dedicated policy language:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-ini\"\u003e\u003cbutton class=\"copy-btn\"\u003eCopy\u003c/button\u003e\u003cspan class=\"hljs-comment\"\u003e# model.conf - Defines the permission structure\u003c/span\u003e\n\u003cspan class=\"hljs-section\"\u003e[request_definition]\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003er\u003c/span\u003e = sub, obj, act\n\n\u003cspan class=\"hljs-section\"\u003e[policy_definition]\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003ep\u003c/span\u003e = sub, obj, act\n\n\u003cspan class=\"hljs-section\"\u003e[matchers]\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003em\u003c/span\u003e = r.sub == p.sub \u0026amp;\u0026amp; r.obj == p.obj \u0026amp;\u0026amp; r.act == p.act\n\u003c/code\u003e\u003c/pre\u003e\u003cpre\u003e\u003ccode class=\"hljs language-csv\"\u003e\u003cbutton class=\"copy-btn\"\u003eCopy\u003c/button\u003e# policy.csv - The actual rules\np, admin, document, read\np, admin, document, update\np, admin, document, delete\np, editor, document, read\np, editor, document, update\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e\u003cstrong\u003ePros:\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ePolicies are separate from application code\u003c/li\u003e\n\u003cli\u003eCan update policies without redeploying\u003c/li\u003e\n\u003cli\u003eSame policies work across different services\u003c/li\u003e\n\u003cli\u003eEasier to audit (policies in one place)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eCons:\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eMust learn a new language\u003c/li\u003e\n\u003cli\u003eLimited IDE support (usually)\u003c/li\u003e\n\u003cli\u003eDebugging across language boundary is harder\u003c/li\u003e\n\u003cli\u003eExtra infrastructure to manage policy files\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003ePopular DSL libraries:\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCasbin\u003c/strong\u003e - Supports multiple languages\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eOpen Policy Agent (OPA)\u003c/strong\u003e - Uses Rego language\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCedar\u003c/strong\u003e - AWS\u0026#39;s policy language\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eOur Example Libraries\u003c/h2\u003e\n\u003cp\u003eYou may have already noticed our ABAC system is an in code system and is actually heavily inspired by CASL which we will be implementing in this course.\u003c/p\u003e\n\u003ch3\u003eCASL (In-Code)\u003c/h3\u003e\n\u003cp\u003eCASL is a popular JavaScript/TypeScript library for handling permissions:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-typescript\"\u003e\u003cbutton class=\"copy-btn\"\u003eCopy\u003c/button\u003e\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { \u003cspan class=\"hljs-title class_\"\u003eAbilityBuilder\u003c/span\u003e, createMongoAbility } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;@casl/ability\u0026quot;\u003c/span\u003e\n\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e { can, build } = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eAbilityBuilder\u003c/span\u003e(createMongoAbility)\n\n\u003cspan class=\"hljs-title function_\"\u003ecan\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;read\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;Document\u0026quot;\u003c/span\u003e, { \u003cspan class=\"hljs-attr\"\u003estatus\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;published\u0026quot;\u003c/span\u003e })\n\u003cspan class=\"hljs-title function_\"\u003ecan\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;update\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;Document\u0026quot;\u003c/span\u003e, { \u003cspan class=\"hljs-attr\"\u003ecreatorId\u003c/span\u003e: user.\u003cspan class=\"hljs-property\"\u003eid\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003eisLocked\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e })\n\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e ability = \u003cspan class=\"hljs-title function_\"\u003ebuild\u003c/span\u003e()\n\n\u003cspan class=\"hljs-comment\"\u003e// Check permissions\u003c/span\u003e\nability.\u003cspan class=\"hljs-title function_\"\u003ecan\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;read\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-title function_\"\u003esubject\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;Document\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-variable language_\"\u003edocument\u003c/span\u003e))\nability.\u003cspan class=\"hljs-title function_\"\u003ecan\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;update\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-title function_\"\u003esubject\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;Document\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-variable language_\"\u003edocument\u003c/span\u003e))\n\u003c/code\u003e\u003c/pre\u003e\u003ch3\u003eCasbin (DSL)\u003c/h3\u003e\n\u003cp\u003eCasbin uses a model/policy separation where you define:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\u003cstrong\u003eModel file\u003c/strong\u003e - The structure of your permissions\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ePolicy file\u003c/strong\u003e - The actual rules\u003c/li\u003e\n\u003c/ol\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-ini\"\u003e\u003cbutton class=\"copy-btn\"\u003eCopy\u003c/button\u003e\u003cspan class=\"hljs-comment\"\u003e# model.conf - Defines the structure\u003c/span\u003e\n\u003cspan class=\"hljs-section\"\u003e[request_definition]\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003er\u003c/span\u003e = sub, obj, act\n\n\u003cspan class=\"hljs-section\"\u003e[policy_definition]\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003ep\u003c/span\u003e = sub, obj, act\n\n\u003cspan class=\"hljs-section\"\u003e[policy_effect]\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003ee\u003c/span\u003e = some(where (p.eft == allow))\n\n\u003cspan class=\"hljs-section\"\u003e[matchers]\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003em\u003c/span\u003e = r.sub == p.sub \u0026amp;\u0026amp; r.obj == p.obj \u0026amp;\u0026amp; r.act == p.act\n\u003c/code\u003e\u003c/pre\u003e\u003cpre\u003e\u003ccode class=\"hljs language-csv\"\u003e\u003cbutton class=\"copy-btn\"\u003eCopy\u003c/button\u003e# policy.csv - The actual rules\np, admin, document, read\np, admin, document, create\np, admin, document, update\np, admin, document, delete\np, editor, document, read\np, editor, document, update\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eCasbin\u0026#39;s approach is much harder to parse until you learn the language around it, but it is more flexible since you can use it across multiple languages and services.\u003c/p\u003e\n\u003ch2\u003eWhich Should You Choose?\u003c/h2\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eFactor\u003c/th\u003e\n\u003cth\u003eIn-Code (CASL)\u003c/th\u003e\n\u003cth\u003eDSL (Casbin)\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\u003ctr\u003e\n\u003ctd\u003e\u003cstrong\u003eLearning curve\u003c/strong\u003e\u003c/td\u003e\n\u003ctd\u003eEasy if you know JS\u003c/td\u003e\n\u003ctd\u003eMust learn new syntax\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003cstrong\u003eType safety\u003c/strong\u003e\u003c/td\u003e\n\u003ctd\u003eFull TypeScript support\u003c/td\u003e\n\u003ctd\u003eLimited\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003cstrong\u003ePolicy updates\u003c/strong\u003e\u003c/td\u003e\n\u003ctd\u003eMay require a redeploy\u003c/td\u003e\n\u003ctd\u003eCan update dynamically\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003cstrong\u003eMulti-service\u003c/strong\u003e\u003c/td\u003e\n\u003ctd\u003eHarder to share\u003c/td\u003e\n\u003ctd\u003eBuilt for this\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003cstrong\u003eDebugging\u003c/strong\u003e\u003c/td\u003e\n\u003ctd\u003eSame tools\u003c/td\u003e\n\u003ctd\u003eHarder\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\u003c/table\u003e\n\u003cp\u003e\u003cstrong\u003eChoose in-code (CASL) when:\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eYour app is monolithic or has few services that use other languages\u003c/li\u003e\n\u003cli\u003eYou want maximum type safety\u003c/li\u003e\n\u003cli\u003eYour team is JavaScript/TypeScript focused\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eChoose DSL (Casbin) when:\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eYou have multiple services sharing policies across different languages\u003c/li\u003e\n\u003cli\u003eYou need to update policies without deploying\u003c/li\u003e\n\u003cli\u003eYou have a security team managing policies\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eWhat\u0026#39;s Next\u003c/h2\u003e\n\u003cp\u003eIn the next lesson, we\u0026#39;ll dive deeper into how to implement CASL in our existing application.\u003c/p\u003e\n","markdown":"\nWe've built our own ABAC system from scratch, which is great for understanding how permissions work. But in production, you might want to use a battle-tested library instead.\n\n## When to Use a Library\n\nBuilding your own permission system makes sense when:\n\n- Learning how permissions work (like this course!)\n- You need maximum control over your permission logic\n- Your permissions aren't too complex\n\nUsing a library makes sense when:\n\n- You want well-tested, production-ready code\n- You need advanced features\n- You want to follow established patterns\n- Your team needs documentation and community support\n\n## Two Types of Permission Libraries\n\nPermission libraries generally fall into two main categories based on how you define policies:\n\n### 1. In-Code Libraries\n\nThese libraries define permissions using the same programming language as your application:\n\n```typescript\n// Permissions defined in JavaScript/TypeScript\nconst ability = defineAbility((can, cannot) =\u003e {\n  can(\"read\", \"Document\", { status: \"published\" })\n  can(\"update\", \"Document\", { creatorId: user.id })\n  cannot(\"delete\", \"Document\", { isLocked: true })\n})\n```\n\n**Pros:**\n\n- Full IDE support (autocomplete, type checking)\n- Easy to debug (same language, same tools)\n- No context switching between languages\n- Can use application logic directly\n\n**Cons:**\n\n- Policies are embedded in application code\n- Harder to externalize or share policies\n- Changes require redeploying the application (unless using a dynamic configuration system)\n\n**Popular in-code libraries:**\n\n- **CASL** (JavaScript/TypeScript)\n- **Pundit** (Ruby)\n- **Cancan** (Ruby)\n\n### 2. DSL Libraries (Domain-Specific Language)\n\nThese libraries define permissions using a dedicated policy language:\n\n```ini\n# model.conf - Defines the permission structure\n[request_definition]\nr = sub, obj, act\n\n[policy_definition]\np = sub, obj, act\n\n[matchers]\nm = r.sub == p.sub \u0026\u0026 r.obj == p.obj \u0026\u0026 r.act == p.act\n```\n\n```csv\n# policy.csv - The actual rules\np, admin, document, read\np, admin, document, update\np, admin, document, delete\np, editor, document, read\np, editor, document, update\n```\n\n**Pros:**\n\n- Policies are separate from application code\n- Can update policies without redeploying\n- Same policies work across different services\n- Easier to audit (policies in one place)\n\n**Cons:**\n\n- Must learn a new language\n- Limited IDE support (usually)\n- Debugging across language boundary is harder\n- Extra infrastructure to manage policy files\n\n**Popular DSL libraries:**\n\n- **Casbin** - Supports multiple languages\n- **Open Policy Agent (OPA)** - Uses Rego language\n- **Cedar** - AWS's policy language\n\n## Our Example Libraries\n\nYou may have already noticed our ABAC system is an in code system and is actually heavily inspired by CASL which we will be implementing in this course.\n\n### CASL (In-Code)\n\nCASL is a popular JavaScript/TypeScript library for handling permissions:\n\n```typescript\nimport { AbilityBuilder, createMongoAbility } from \"@casl/ability\"\n\nconst { can, build } = new AbilityBuilder(createMongoAbility)\n\ncan(\"read\", \"Document\", { status: \"published\" })\ncan(\"update\", \"Document\", { creatorId: user.id, isLocked: false })\n\nconst ability = build()\n\n// Check permissions\nability.can(\"read\", subject(\"Document\", document))\nability.can(\"update\", subject(\"Document\", document))\n```\n\n### Casbin (DSL)\n\nCasbin uses a model/policy separation where you define:\n\n1. **Model file** - The structure of your permissions\n2. **Policy file** - The actual rules\n\n```ini\n# model.conf - Defines the structure\n[request_definition]\nr = sub, obj, act\n\n[policy_definition]\np = sub, obj, act\n\n[policy_effect]\ne = some(where (p.eft == allow))\n\n[matchers]\nm = r.sub == p.sub \u0026\u0026 r.obj == p.obj \u0026\u0026 r.act == p.act\n```\n\n```csv\n# policy.csv - The actual rules\np, admin, document, read\np, admin, document, create\np, admin, document, update\np, admin, document, delete\np, editor, document, read\np, editor, document, update\n```\n\nCasbin's approach is much harder to parse until you learn the language around it, but it is more flexible since you can use it across multiple languages and services.\n\n## Which Should You Choose?\n\n| Factor             | In-Code (CASL)          | DSL (Casbin)           |\n| ------------------ | ----------------------- | ---------------------- |\n| **Learning curve** | Easy if you know JS     | Must learn new syntax  |\n| **Type safety**    | Full TypeScript support | Limited                |\n| **Policy updates** | May require a redeploy  | Can update dynamically |\n| **Multi-service**  | Harder to share         | Built for this         |\n| **Debugging**      | Same tools              | Harder                 |\n\n**Choose in-code (CASL) when:**\n\n- Your app is monolithic or has few services that use other languages\n- You want maximum type safety\n- Your team is JavaScript/TypeScript focused\n\n**Choose DSL (Casbin) when:**\n\n- You have multiple services sharing policies across different languages\n- You need to update policies without deploying\n- You have a security team managing policies\n\n## What's Next\n\nIn the next lesson, we'll dive deeper into how to implement CASL in our existing application.\n","slug":"why-use-a-library","title":"Why Use a Permission Library?","section":"Permission Libraries","icon":"cubes","filePath":"/home/runner/work/fem-permission-systems-that-scale/fem-permission-systems-that-scale/lessons/05-permission-libraries/A-why-use-a-library.md","nextSlug":"/fem-permission-systems-that-scale/lessons/permission-libraries/upgrading-to-casl","prevSlug":"/fem-permission-systems-that-scale/lessons/abac/clean-architecture-services"}},"__N_SSG":true},"page":"/lessons/[section]/[slug]","query":{"section":"permission-libraries","slug":"why-use-a-library"},"buildId":"Z1s-VsOExbnNujkBZEKnx","assetPrefix":"/fem-permission-systems-that-scale","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>